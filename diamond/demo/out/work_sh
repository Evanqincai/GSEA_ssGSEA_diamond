perl /lustre/rdi/user/licq/research/RNA_seq/diamond/random_extract_fq.pl /lustre/rdi/user/licq/project/RNA-Seq/20180827_henan_RNA/diamond/lowQua_rawdata/HB02T_S2.R1.fastq.gz 60 out/fasta/HB02T_S2.R1.random >out/fasta/HB02T_S2.R1.fasta
/lustre/rdi/user/licq/research/diamond/diamond-soft/diamond blastx -d /lustre/rdi/user/licq/project/RNA-Seq/20180827_henan_RNA/diamond/NR/nr -q out/fasta/HB02T_S2.R1.fasta -o out/HB02T_S2.R1.matches.m8 -f 102 -p 4
awk -F '\t' 'NR==FNR{a[$1]=$2}NR!=FNR{if(a[$2]){print a[$2]"\t"$0}}' /lustre/rdi/user/licq/project/RNA-Seq/20180827_henan_RNA/diamond/NR_102/taxdmp/taxonid_list out/HB02T_S2.R1.matches.m8|cut -f 1,3|sort -k 2 -n|uniq -c |sort -n -k1 -r |sed 's/\s\+/\t/g' |awk '{print $1"\t"$NF}' >out/tmp 
awk -F '\t' 'NR==FNR{a[$1]=$2}NR!=FNR{if(a[$2]){print a[$2]"\t"$1"\t"$1/60}}' /lustre/rdi/user/licq/project/RNA-Seq/20180827_henan_RNA/diamond/NR_102/taxdmp/taxonid_list  out/tmp|awk -F '\t' '{printf("%s\t%s\t%.2f%\n",$1,$2,$3)}'|sed '1i\Species\tRead_num\tPercentage' |head -n 21 >out/HB02T_S2.R1.stat
perl /lustre/rdi/user/licq/research/RNA_seq/diamond/random_extract_fq.pl /lustre/rdi/user/licq/project/RNA-Seq/20180827_henan_RNA/diamond/lowQua_rawdata/HB04T_S4.R1.fastq.gz 60 out/fasta/HB04T_S4.R1.random >out/fasta/HB04T_S4.R1.fasta
/lustre/rdi/user/licq/research/diamond/diamond-soft/diamond blastx -d /lustre/rdi/user/licq/project/RNA-Seq/20180827_henan_RNA/diamond/NR/nr -q out/fasta/HB04T_S4.R1.fasta -o out/HB04T_S4.R1.matches.m8 -f 102 -p 4
awk -F '\t' 'NR==FNR{a[$1]=$2}NR!=FNR{if(a[$2]){print a[$2]"\t"$0}}' /lustre/rdi/user/licq/project/RNA-Seq/20180827_henan_RNA/diamond/NR_102/taxdmp/taxonid_list out/HB04T_S4.R1.matches.m8|cut -f 1,3|sort -k 2 -n|uniq -c |sort -n -k1 -r |sed 's/\s\+/\t/g' |awk '{print $1"\t"$NF}' >out/tmp 
awk -F '\t' 'NR==FNR{a[$1]=$2}NR!=FNR{if(a[$2]){print a[$2]"\t"$1"\t"$1/60}}' /lustre/rdi/user/licq/project/RNA-Seq/20180827_henan_RNA/diamond/NR_102/taxdmp/taxonid_list  out/tmp|awk -F '\t' '{printf("%s\t%s\t%.2f%\n",$1,$2,$3)}'|sed '1i\Species\tRead_num\tPercentage' |head -n 21 >out/HB04T_S4.R1.stat
